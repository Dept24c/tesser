<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><link href="css/default.css" rel="stylesheet" type="text/css" /><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><script src="js/highlight.min.js" type="text/javascript"></script><link href="css/highlight.css" rel="stylesheet" type="text/css" /><script>hljs.initHighlightingOnLoad();</script><title>tesser.hadoop documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Tesser.all</span> <span class="project-version">1.0.3</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tesser</span></div></div></li><li class="depth-2 branch"><a href="tesser.cardinality.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cardinality</span></div></a></li><li class="depth-2 branch"><a href="tesser.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 current"><a href="tesser.hadoop.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>hadoop</span></div></a></li><li class="depth-3"><a href="tesser.hadoop.serialization.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>serialization</span></div></a></li><li class="depth-2 branch"><a href="tesser.math.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>math</span></div></a></li><li class="depth-2 branch"><a href="tesser.quantiles.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>quantiles</span></div></a></li><li class="depth-2 branch"><a href="tesser.simple.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>simple</span></div></a></li><li class="depth-2"><a href="tesser.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="tesser.hadoop.html#var-dsink"><div class="inner"><span>dsink</span></div></a></li><li class="depth-1"><a href="tesser.hadoop.html#var-error.3F"><div class="inner"><span>error?</span></div></a></li><li class="depth-1"><a href="tesser.hadoop.html#var-execute"><div class="inner"><span>execute</span></div></a></li><li class="depth-1"><a href="tesser.hadoop.html#var-fold"><div class="inner"><span>fold</span></div></a></li><li class="depth-1"><a href="tesser.hadoop.html#var-fold*"><div class="inner"><span>fold*</span></div></a></li><li class="depth-1"><a href="tesser.hadoop.html#var-fold-mapper"><div class="inner"><span>fold-mapper</span></div></a></li><li class="depth-1"><a href="tesser.hadoop.html#var-fold-reduce-twice"><div class="inner"><span>fold-reduce-twice</span></div></a></li><li class="depth-1"><a href="tesser.hadoop.html#var-fold-reducer"><div class="inner"><span>fold-reducer</span></div></a></li><li class="depth-1"><a href="tesser.hadoop.html#var-fold-reducer-without-post-combiner"><div class="inner"><span>fold-reducer-without-post-combiner</span></div></a></li><li class="depth-1"><a href="tesser.hadoop.html#var-gen-job-name.21"><div class="inner"><span>gen-job-name!</span></div></a></li><li class="depth-1"><a href="tesser.hadoop.html#var-identity-mapper"><div class="inner"><span>identity-mapper</span></div></a></li><li class="depth-1"><a href="tesser.hadoop.html#var-job-name-counter"><div class="inner"><span>job-name-counter</span></div></a></li><li class="depth-1"><a href="tesser.hadoop.html#var-partition-randomly"><div class="inner"><span>partition-randomly</span></div></a></li><li class="depth-1"><a href="tesser.hadoop.html#var-print-error"><div class="inner"><span>print-error</span></div></a></li><li class="depth-1"><a href="tesser.hadoop.html#var-rehydrate-fold"><div class="inner"><span>rehydrate-fold</span></div></a></li><li class="depth-1"><a href="tesser.hadoop.html#var-resolve.2B"><div class="inner"><span>resolve+</span></div></a></li><li class="depth-1"><a href="tesser.hadoop.html#var-serialize-error"><div class="inner"><span>serialize-error</span></div></a></li><li class="depth-1"><a href="tesser.hadoop.html#var-set-one-reducer.21"><div class="inner"><span>set-one-reducer!</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">tesser.hadoop</h1><div class="doc"><div class="markdown"><p>Helps you run a fold on Hadoop!</p></div></div><div class="public anchor" id="var-dsink"><h3>dsink</h3><div class="usage"><code>(dsink work-dir file-name)</code></div><div class="doc"><div class="markdown"><p>Given a work directory and a string name for this file, builds a dsink for a fold to dump its output to, in <code>[NullWritable FressianWritable]</code> format.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L181">view source</a></div></div><div class="public anchor" id="var-error.3F"><h3>error?</h3><div class="usage"><code>(error? x)</code></div><div class="doc"><div class="markdown"><p>Is this an error object?</p></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L76">view source</a></div></div><div class="public anchor" id="var-execute"><h3>execute</h3><div class="usage"><code>(execute graph conf)</code><code>(execute graph conf job-name)</code></div><div class="doc"><div class="markdown"><p>Like <code>parkour.graph/execute</code>, but specialized for folds. Takes a parkour graph, a jobconf, and a job name. Executes the job, then returns a sequence of fold results. Job names will be automatically generated if not provided.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L170">view source</a></div></div><div class="public anchor" id="var-fold"><h3>fold</h3><div class="usage"><code>(fold conf input workdir fold-var &amp; args)</code></div><div class="doc"><div class="markdown"><p>A simple, all-in-one fold operation. Takes a jobconf, workdir, input dseq, var which points to a fold function, and arguments for the fold function. Runs the fold against the dseq and returns its results. Names output dsink after metadata key :tesser.hadoop/output-path in fold symbol. If absent, uses the conf key tesser.hadoop.output-path and finally falls back to the fold symbol. On error, throws an <code>ex-info</code>.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L202">view source</a></div></div><div class="public anchor" id="var-fold*"><h3>fold*</h3><div class="usage"><code>(fold* graph fold-var &amp; args)</code></div><div class="doc"><div class="markdown"><p>Takes a Parkour graph and applies a fold to it. Takes a var for a function, taking <code>args</code>, which constructs a fold. Returns a new (unexecuted) graph. The output of this job will be a single-element Fressian structure containing the results of the fold applied to the jobâ€™s inputs.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L145">view source</a></div></div><div class="public anchor" id="var-fold-mapper"><h3>fold-mapper</h3><div class="usage"><code>(fold-mapper fold-name fold-args input)</code></div><div class="doc"><div class="markdown"><p>A generic, stateful hadoop mapper for applying a fold to a Hadoop dataset. This function returns a mapper for fold defined by make-fold applied to fold-name &amp; additional args.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L101">view source</a></div></div><div class="public anchor" id="var-fold-reduce-twice"><h3>fold-reduce-twice</h3><div class="usage"><code>(fold-reduce-twice conf input workdir fold-var &amp; args)</code></div><div class="doc"><div class="markdown"><p>Like fold, but in two stages (jobs). First job uses the number of reduce tasks specified in mapred.reduce.tasks. The second job does nothing in the map step, then uses one reduce task.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L257">view source</a></div></div><div class="public anchor" id="var-fold-reducer"><h3>fold-reducer</h3><div class="usage"><code>(fold-reducer fold-name fold-args input)</code></div><div class="doc"><div class="markdown"><p>This function returns a parkour reducer for fold defined by make-fold applied to fold-name &amp; additional args</p></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L122">view source</a></div></div><div class="public anchor" id="var-fold-reducer-without-post-combiner"><h3>fold-reducer-without-post-combiner</h3><div class="usage"><code>(fold-reducer-without-post-combiner fold-name fold-args input)</code></div><div class="doc"><div class="markdown"><p>Like fold-reducer, but omits :post-combiner so it can be used in reduce tasks that are continued in multiple jobs.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L237">view source</a></div></div><div class="public anchor" id="var-gen-job-name.21"><h3>gen-job-name!</h3><div class="usage"><code>(gen-job-name!)</code></div><div class="doc"><div class="markdown"><p>Generates a new job name. Job names start at a random small integer and increment sequentially from there. Job names are printed to stderr when generated.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L160">view source</a></div></div><div class="public anchor" id="var-identity-mapper"><h3>identity-mapper</h3><div class="usage"><code>(identity-mapper records)</code></div><div class="doc"><div class="markdown"><p>Does nothing in the map step.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L220">view source</a></div></div><div class="public anchor" id="var-job-name-counter"><h3>job-name-counter</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L157">view source</a></div></div><div class="public anchor" id="var-partition-randomly"><h3>partition-randomly</h3><div class="usage"><code>(partition-randomly _ _ nparts)</code></div><div class="doc"><div class="markdown"><p>Partitions map task outputs randomly and uniformly among the reduce tasks.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L227">view source</a></div></div><div class="public anchor" id="var-print-error"><h3>print-error</h3><div class="usage"><code>(print-error e)</code></div><div class="doc"><div class="markdown"><p>Print an error to <em>err</em>.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L82">view source</a></div></div><div class="public anchor" id="var-rehydrate-fold"><h3>rehydrate-fold</h3><div class="usage"><code>(rehydrate-fold fold-name fold-args)</code></div><div class="doc"><div class="markdown"><p>Takes the name of a function that generates a fold (a symbol) and args for that function, and invokes the function with args to build a fold, which is then compiled and returned.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L46">view source</a></div></div><div class="public anchor" id="var-resolve.2B"><h3>resolve+</h3><div class="usage"><code>(resolve+ sym)</code></div><div class="doc"><div class="markdown"><p>Resolves a symbol to a var, requiring the namespace if necessary. If the namespace doesnâ€™t exist, throws just like <code>clojure.core/require</code>. If the symbol doesnâ€™t exist after requiring, returns nil.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L36">view source</a></div></div><div class="public anchor" id="var-serialize-error"><h3>serialize-error</h3><div class="usage"><code>(serialize-error state input e)</code></div><div class="doc"><div class="markdown"><p>Convert an exception to an error.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L57">view source</a></div></div><div class="public anchor" id="var-set-one-reducer.21"><h3>set-one-reducer!</h3><div class="usage"><code>(set-one-reducer! conf)</code></div><div class="doc"><div class="markdown"><p>Takes a jobconf, returns the jobconf with mapred.reduce.tasks set to 1.</p></div></div><div class="src-link"><a href="http://github.com/aphyr/tesser/blob/1.0.3/../hadoop/src/tesser/hadoop.clj#L232">view source</a></div></div></div></body></html>